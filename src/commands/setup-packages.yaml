# src/commands/setup-packages.yaml

description: >
  Install specified terraform version on executor.
  
  requirements:
  - curl
  - sudo. Keep in mind that the install will use sudo since it assumes the container is running as a defined USER.

parameters:

  terraform-version:
    description: must provide the release version of terraform
    type: string
    default: ""

  use-sudo:
    description: whether to perform the install with sudo, default is true
    type: boolean 
    default: true

steps:
  - when:
      condition: << parameters.terraform-version >>
      steps:
        - run:
            name: install terraform
            command: |
              curl -SLO "https://releases.hashicorp.com/terraform/<< parameters.terraform-version >>/terraform_<< parameters.terraform-version >>_linux_amd64.zip"
              <<#parameters.use-sudo>>sudo<<\parameters.use-sudo>> unzip -o "terraform_<< parameters.terraform-version >>_linux_amd64.zip" -d /usr/local/bin

